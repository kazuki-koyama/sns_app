function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
};
async function add_image() {
  await sleep(3*1000);
  $(".posts").prepend("<%= j(render "post-item", post: @post) %>");
};
<% if @status == 'success' %>
  add_image();
<% elsif @status == 'fail' %>
  alert('before画像とafter画像が正しく選択されているかご確認ください');
<% end %>
$("#new-post").modal("hide");